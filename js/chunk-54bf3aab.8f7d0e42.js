(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54bf3aab","chunk-d23254a4"],{"3ca4":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t._self._c;return e("div",[e("div",{ref:"questionContainer",staticClass:"question my-2 ml-2 p-3 mx-0",attrs:{id:t.id},on:{click:function(e){return t.openDetailQuestion(e)}}},[e("div",{staticClass:"info"},[e("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center"}},[e("el-avatar",{attrs:{size:t.avatarSize,src:t.avatarUrl?t.avatarUrl:"https://res.cloudinary.com/dpxcvonet/image/upload/v1729304643/jjfd84acjaamikeefdzr.jpg"}}),e("div",{staticStyle:{display:"flex","flex-direction":"column"}},[e("span",{staticClass:"author"},[t._v(t._s(t.user))]),e("span",{staticClass:"date"},[t._v(t._s(t.createdAt))])])],1),t._id===this.$store.getters.user._id?e("el-dropdown",{on:{command:t.handleDropdownCommand,click:function(t){t.stopPropagation()}}},[e("span",{staticClass:"el-dropdown-link"},[e("i",{staticClass:"el-icon-more",on:{click:function(t){t.stopPropagation()}}})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.status?t._e():e("el-dropdown-item",{attrs:{icon:"el-icon-edit",command:"edit"}},[t._v("\n            Sửa\n          ")]),e("el-dropdown-item",{attrs:{icon:"el-icon-delete",command:"delete"}},[t._v("Xoá bài")])],1)],1):t._e()],1),e("div",{staticClass:"title"},[t._v("\n      [Câu hỏi] "+t._s(t.title)+"\n    ")]),t.showFullContent?e("div",{staticClass:"content"},[e("div",{domProps:{innerHTML:t._s(t.formattedContent)}}),t.content.length>t.maxContentLength?e("div",{staticClass:"toggle-button-full-content",on:{click:function(e){return e.stopPropagation(),t.toggleContent.apply(null,arguments)}}},[t._v("\n        "+t._s(t.showFullContent?"Thu gọn":"xem thêm")+"\n      ")]):t._e()]):e("div",{staticClass:"content"},[e("div",{domProps:{innerHTML:t._s(t.formattedTruncatedContent)}}),t.content.length>t.maxContentLength?e("div",{staticClass:"toggle-button-truncated-content",on:{click:function(e){return e.stopPropagation(),t.toggleContent.apply(null,arguments)}}},[t._v("\n        "+t._s(t.showFullContent?"Thu gọn":"xem thêm")+"\n      ")]):t._e()]),e("div",{staticClass:"actions"},[e("div",{staticClass:"like-container"},[e("i",{staticClass:"fa fa-heart-o",attrs:{"aria-hidden":"true"},on:{click:function(e){return e.stopPropagation(),t.likeQuestion.apply(null,arguments)}}}),e("span",{staticClass:"likes"},[t._v(t._s(t.likesCount))])]),e("div",{staticClass:"comment-container"},[e("el-icon",{staticClass:"el-icon-chat-dot-square",staticStyle:{color:"rgb(24, 61, 228)"}}),e("span",{staticClass:"comments"},[t._v(t._s(t.comments))])],1)]),e("div",{staticClass:"reply-container"},[e("div",{staticClass:"avatar"},[e("el-avatar",{attrs:{size:t.avatarSize,src:this.$store.getters.currentUser&&this.$store.getters.currentUser.avatarUrl?this.$store.getters.currentUser.avatarUrl:"https://res.cloudinary.com/dpxcvonet/image/upload/v1729304643/jjfd84acjaamikeefdzr.jpg"}})],1),e("div",{staticClass:"input-box"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.replyText,expression:"replyText"}],staticClass:"reply-input",attrs:{placeholder:"Nhập phản hồi của bạn..."},domProps:{value:t.replyText},on:{input:[function(e){e.target.composing||(t.replyText=e.target.value)},t.onReplyInputChange]}})]),e("div",{staticClass:"send-button mr-3"},[e("i",{staticClass:"fa fa-paper-plane",staticStyle:{color:"rgb(22, 77, 228)"},attrs:{"aria-hidden":"true"},on:{click:t.sendReply}})])])]),e("detailQuestionVue",{ref:"childRef",attrs:{id:t.id,title:t.title,content:t.content,_id:t._id,avatarUrl:t.avatarUrl?t.avatarUrl:"",user:t.user,createdAt:t.createdAt,likes:t.likesCount,comments:t.comments}})],1)},s=[],o=(i("4f37"),i("96cf"),i("1da1")),a=(i("a481"),i("c5f6"),i("188b")),r=i("b166"),c=i("2ac8"),u=i("9f3e"),l={props:{title:String,content:String,_id:String,id:String,user:String,status:Boolean,createdAt:String,avatarUrl:String,likes:Number,comments:Number},data:function(){return{showFullContent:!1,maxContentLength:350,showPopup:!1,replyText:"",isInviteMemberVisible:!1,likesCount:0}},computed:{avatarSize:function(){return"small"},formattedCreatedAt:function(){return this.createdAt?this.formatDate(new Date(this.createdAt)):""},formattedContent:function(){return this.content.replace(/\n/g,"<br>")},formattedTruncatedContent:function(){var t=this.truncatedContent.replace(/\n/g,"<br>");return t},truncatedContent:function(){return this.content.length>this.maxContentLength?this.content.slice(0,this.maxContentLength)+"...":this.content}},components:{detailQuestionVue:a["default"]},created:function(){this.likesCount=this.likes},methods:{editQuestion:function(){this.$emit("edit",{id:this.id,title:this.title,content:this.content,_id:this._id})},formatDate:function(t){return t?Object(r["a"])(t,"dd/MM/yyyy HH:mm"):""},likeQuestion:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.likesCount++,t.prev=1,t.next=4,Object(c["f"])(this.id);case 4:t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](1),console.error("Lỗi khi cập nhật lượt thích: ",t.t0);case 9:case"end":return t.stop()}}),t,this,[[1,6]])})));function e(){return t.apply(this,arguments)}return e}(),toggleContent:function(){this.showFullContent=!this.showFullContent},openDetailQuestion:function(t){t.stopPropagation(),this.$refs.childRef.childFunction()},onReplyInputChange:function(){console.log("123")},sendReply:function(){""!==this.replyText.trim()&&(this.replyText="")},handleDropdownCommand:function(t){"edit"===t?this.editQuestion():"delete"===t&&this.confirmDelete()},confirmDelete:function(){var t=this;this.$confirm("Xác nhận xóa","Cảnh báo",{confirmButtonText:"Xóa",type:"warning"}).then((function(){Object(c["c"])(t.id).then((function(e){var i=e.data;i.success&&(Object(u["b"])(t.id),t.$emit("pinnedStatusUpdated"))})).finally((function(){t.$wrLoading(!1)}))})).catch()},toggleEdit:function(){}}},d=l,h=(i("673d"),i("2877")),p=Object(h["a"])(d,n,s,!1,null,"4ff4fb3c",null);e["default"]=p.exports},"51db":function(t,e,i){},"673d":function(t,e,i){"use strict";i("51db")},"809c":function(t,e,i){},"9ff0":function(t,e,i){"use strict";i.r(e);i("386d");var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"question-container"},[e("div",{staticClass:"container"},[e("div",{staticClass:"main"},[e("div",[e("div",{staticClass:"d-flex align-items-center p-2"},[e("el-input",{staticClass:"input-question-index",attrs:{size:"mini",placeholder:"Tìm theo tên câu hỏi..."},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),e("el-button",{staticClass:"ml-2",attrs:{icon:"el-icon-search",type:"success",circle:""}})],1)]),e("div",{staticClass:"question-button-container"},[e("div",{staticClass:"avatar"},[e("el-avatar",{attrs:{size:t.avatarSize,src:this.$store.getters.currentUser&&this.$store.getters.currentUser.avatarUrl?this.$store.getters.currentUser.avatarUrl:"https://res.cloudinary.com/dpxcvonet/image/upload/v1729304643/jjfd84acjaamikeefdzr.jpg"}})],1),e("div",{staticClass:"input-box"},[e("input",{staticClass:"reply-inputs",attrs:{placeholder:"Nhập nội dung câu hỏi..."},on:{input:t.onReplyInputChange,click:t.showQuestionPopup}})])]),e("el-scrollbar",{staticStyle:{height:"80vh","overflow-y":"auto"},attrs:{"wrap-class":"question-list"}},t._l(t.filteredQuestions,(function(i){return e("question",{key:i._id,ref:i._id,refInFor:!0,attrs:{title:i.title,content:i.content,avatarUrl:i.user&&i.user.avatarUrl?i.user.avatarUrl:"https://res.cloudinary.com/dpxcvonet/image/upload/v1729304643/jjfd84acjaamikeefdzr.jpg",user:i.user&&i.user.fullname?i.user.fullname:"Không tên",createdAt:t.formatDate(i.createdAt),likes:i.likes,id:i._id,comments:i.comments,status:i.status,_id:i.user&&i.user._id?i.user._id:null},on:{pinnedStatusUpdated:t.loadQuestions,edit:t.openEditDialog}})})),1)],1)]),e("el-dialog",{staticClass:"custom-dialog-question",attrs:{visible:t.isQuestionPopupVisible},on:{"update:visible":function(e){t.isQuestionPopupVisible=e}}},[e("p",{staticClass:"title-dialog-question"},[t._v(t._s(t.dialogTitle))]),e("div",{staticClass:"el-dialog__body p-3"},[e("p",{staticClass:"font-weight-bold"},[t._v("Tiêu đề")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.titleQuestion,expression:"titleQuestion"}],staticClass:"reply-inputs",attrs:{placeholder:"Nhập tiêu đề câu hỏi ..."},domProps:{value:t.titleQuestion},on:{input:function(e){e.target.composing||(t.titleQuestion=e.target.value)}}}),e("p",{staticClass:"font-weight-bold"},[t._v("Nội dung câu hỏi")]),e("ckeditor",{attrs:{editor:t.editor},model:{value:t.questionText,callback:function(e){t.questionText=e},expression:"questionText"}}),e("div",{staticClass:"button-container-tall mt-2"},[e("el-button",{staticClass:"close-button",attrs:{type:"danger",icon:"el-icon-close"},on:{click:function(e){t.isQuestionPopupVisible=!1}}},[t._v("Đóng")]),e("el-button",{staticClass:"refresh-button",attrs:{type:"warning",icon:"el-icon-refresh"},on:{click:t.resetQuestionText}},[t._v("Làm mới")]),e("el-button",{attrs:{type:"success"},on:{click:t.onSaveButtonClick}},[t._v("Đăng")])],1)],1)])],1)},s=[],o=(i("4f37"),i("96cf"),i("1da1")),a=(i("6762"),i("2fdb"),i("d25f"),i("ade3")),r=i("3ca4"),c=i("2ac8"),u=i("b166"),l=i("6930"),d=i.n(l),h=i("fb3d"),p=i.n(h),f=i("277f"),m={data:function(){return Object(a["a"])({logo:"https://upload.wikimedia.org/wikipedia/vi/2/2e/Dai_hoc_phu_yen_logo.png",replyText:"",inputValue:"",questions:[],color:"white",isInviteMemberVisible:!1,isQuestionPopupVisible:!1,questionText:"",titleQuestion:"",selectedQuestionId:null,editor:p.a,isEditing:!1,search:""},"questions",[])},components:{Question:r["default"],ckeditor:d.a.component},mounted:function(){this.loadQuestions()},updated:function(){this.$route.params.id&&this.scrollToQuestion()},computed:{avatarSize:function(){return"small"},cleanQuestionText:function(){return this.questionText},dialogTitle:function(){return this.isEditing?"SỬA CÂU HỎI":"TẠO CÂU HỎI"},filteredQuestions:function(){var t=this;return this.questions.filter((function(e){return e.title.toLowerCase().includes(t.search.toLowerCase())}))}},methods:{onSaveButtonClick:function(){this.isEditing?this.submitEditedQuestion():this.submitQuestion()},openEditDialog:function(t){this.isQuestionPopupVisible=!0,this.isEditing=!0,this.idQuestion=t.id,this.titleQuestion=t.title,this.questionText=t.content,this.selectedQuestionId=t._id},submitEditedQuestion:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={title:this.titleQuestion,content:this.questionText,user:this.selectedQuestionId},t.next=3,Object(c["g"])(this.idQuestion,e);case 3:i=t.sent,i&&200===i.status&&(this.loadQuestions(),this.questionText="",this.titleQuestion="",this.isEditing=!1),this.isQuestionPopupVisible=!1,this.questionText="",this.titleQuestion="";case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),scrollToQuestion:function(){var t=document.getElementById(this.$route.params.id);t&&t.scrollIntoView({behavior:"smooth",block:"start"})},showInviteDialog:function(){this.isInviteMemberVisible=!0},showQuestionPopup:function(){this.isQuestionPopupVisible=!0,this.isEditing=!1,this.titleQuestion="",this.questionText=""},formatDate:function(t){return String(Object(u["a"])(new Date(t),"dd/MM/yyyy HH:mm"))},onReplyInputChange:function(){},submitQuestion:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,i,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.questionText.trim(),e){t.next=3;break}return t.abrupt("return");case 3:return i={title:this.titleQuestion,content:this.cleanQuestionText,user:this.$store.getters.user._id},t.prev=4,t.next=7,Object(c["d"])(i);case 7:if(n=t.sent,!n||200!==n.status){t.next=24;break}if(s=n.data,!s||!s.success){t.next=21;break}return t.next=13,this.loadQuestions();case 13:return this.questionText="",this.titleQuestion="",this.isQuestionPopupVisible=!1,t.next=18,Object(f["b"])({user:this.$store.getters.user._id,content:"vừa tạo một câu hỏi mới: ".concat(i.title)});case 18:this.$store.getters.socket.emit("newNotification",{}),t.next=22;break;case 21:console.error("Lỗi khi lưu câu hỏi: ",s);case 22:t.next=25;break;case 24:console.error("Lỗi khi gửi câu hỏi, phản hồi không hợp lệ: ",n);case 25:t.next=30;break;case 27:t.prev=27,t.t0=t["catch"](4),console.error("Lỗi khi gửi câu hỏi: ",t.t0);case 30:case"end":return t.stop()}}),t,this,[[4,27]])})));function e(){return t.apply(this,arguments)}return e}(),loadQuestions:function(){var t=this;Object(c["a"])().then((function(e){e&&e.data&&e.data.success?(t.questions=e.data.questions,t.questions=t.questions.reverse()):console.error("Không thành công: ",e.data)})).catch((function(t){console.error("Lỗi khi tải câu hỏi: ",t)}))},showTimestampPicker:function(){console.log("123")},resetQuestionText:function(){this.titleQuestion="",this.questionText=""}}},v=m,g=(i("f07e"),i("2877")),b=Object(g["a"])(v,n,s,!1,null,null,null);e["default"]=b.exports},f07e:function(t,e,i){"use strict";i("809c")}}]);