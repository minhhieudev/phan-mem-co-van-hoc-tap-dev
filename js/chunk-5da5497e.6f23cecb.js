(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5da5497e"],{"386d":function(t,e,n){"use strict";var a=n("cb7c"),o=n("83a1"),c=n("5f1b");n("214f")("search",1,(function(t,e,n,i){return[function(n){var a=t(this),o=void 0==n?void 0:n[e];return void 0!==o?o.call(n,a):new RegExp(n)[e](String(a))},function(t){var e=i(n,t,this);if(e.done)return e.value;var r=a(t),s=String(this),l=r.lastIndex;o(l,0)||(r.lastIndex=0);var u=c(r,s);return o(r.lastIndex,l)||(r.lastIndex=l),null===u?-1:u.index}]}))},"6c2d":function(t,e,n){"use strict";n("d1c9")},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},b510:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"d",(function(){return s}));var a=n("b775"),o="reply";function c(t){return Object(a["a"])({url:"/".concat(o,"/").concat(t),method:"get"})}function i(t){return Object(a["a"])({url:"/".concat(o,"/deleteReply/").concat(t),method:"delete"})}function r(t){return Object(a["a"])({url:"/".concat(o),method:"post",data:t})}function s(t){return Object(a["a"])({url:"/".concat(o,"/").concat(t),method:"post"})}},caf6:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return r})),n.d(e,"f",(function(){return s})),n.d(e,"g",(function(){return l})),n.d(e,"e",(function(){return u})),n.d(e,"h",(function(){return d})),n.d(e,"b",(function(){return p}));var a=n("b775"),o="post";function c(){return Object(a["a"])({url:"/".concat(o),method:"get"})}function i(t){return Object(a["a"])({url:"/".concat(o,"/").concat(t),method:"delete"})}function r(t){return Object(a["a"])({url:"/".concat(o),method:"post",data:t})}function s(t){return Object(a["a"])({url:"/".concat(o,"/like/").concat(t),method:"post"})}function l(t,e){return Object(a["a"])({url:"/".concat(o,"/updatePinnedStatus/").concat(t),method:"post",data:{pinned:e}})}function u(t,e){return Object(a["a"])({url:"/".concat(o,"/").concat(t,"/count"),method:"post",data:{answersCount:e}})}function d(t,e){return Object(a["a"])({url:"/".concat(o,"/updatePost/").concat(t),method:"post",data:{newPost:e}})}function p(t,e){return Object(a["a"])({url:"/".concat(o,"/paginated"),method:"get",params:{page:t,pageSize:e}})}},d1c9:function(t,e,n){},ee69:function(t,e,n){"use strict";n.r(e);n("386d");var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"Posts ml-3"},[e("el-card",[e("div",{staticClass:"action-post justify-content-between mb-4"},[e("div",{staticClass:"d-flex justify-content-start"},[e("div",{staticClass:"d-flex align-items-center p-2",staticStyle:{color:"rgb(1, 6, 12)"}},[e("i",{staticClass:"fa-solid fa-rotate-right",on:{click:t.resetFilters}}),e("div",{staticClass:"d-flex align-items-center ml-5 border-right"},[e("i",{staticClass:"fa-solid fa-filter mr-3",staticStyle:{color:"rgb(20, 197, 197)"}}),e("el-select",{staticClass:"custom-input-post",attrs:{placeholder:"Loại"},model:{value:t.selectedType,callback:function(e){t.selectedType=e},expression:"selectedType"}},t._l(t.typeList,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1)]),e("div",{staticClass:"d-flex align-items-center p-2"},[e("el-input",{staticClass:"custom-input-post",attrs:{size:"medium",placeholder:"Tìm theo tên Tài liệu / Bài đăng..."},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),e("el-button",{staticClass:"ml-2",attrs:{icon:"el-icon-search",type:"success",circle:""}})],1)]),e("el-button",{attrs:{type:"success",round:""},on:{click:function(e){return t.goToAddNewPage()}}},[t._v("Tạo mới")])],1),e("div",{staticStyle:{"max-height":"71vh","overflow-y":"auto"}},[e("el-table",{staticClass:"custom-table",staticStyle:{width:"100%"},attrs:{data:t.filteredTableData}},[e("el-table-column",{attrs:{label:"STT",width:"70"},scopedSlots:t._u([{key:"default",fn:function(n){var a=n.$index;n.row;return[e("span",[t._v(t._s(a+1+(t.pagination.current_page-1)*t.pagination.page_size))])]}}])}),e("el-table-column",{attrs:{prop:"title",label:"Tên Tài liệu / Bài đăng"},scopedSlots:t._u([{key:"default",fn:function(n){var a=n.row;return[e("span",{staticStyle:{"font-weight":"bold",color:"#09af09"}},[t._v(t._s(a.title))])]}}])}),e("el-table-column",{attrs:{prop:"type",label:"Loại",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v(t._s(n.postType))]}}])}),e("el-table-column",{attrs:{prop:"createdAt",label:"Ngày đăng",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v(t._s(t.formatDate(n.createdAt)))]}}])}),e("el-table-column",{attrs:{label:"Đính kèm"},scopedSlots:t._u([{key:"default",fn:function(n){var a=n.row;return[e("div",{staticClass:"d-flex"},t._l(a.attachmentPath,(function(n){return e("div",{key:n._id,staticClass:"mx-2"},[e("el-dropdown",{on:{command:function(e){return t.handleCommand(e,n)}}},[e("el-button",{class:t.getFileButtonClass(n),attrs:{type:"text"}},[e("i",{staticClass:"size-icon",class:t.getFileIconClass(n.filename).class,style:{color:t.getFileIconClass(n.filename).color}})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{disabled:""}},[t._v(t._s(n.filename))]),e("el-dropdown-item",{attrs:{divided:"",icon:"el-icon-download",command:"download"}},[t._v("Tải xuống")]),e("el-dropdown-item",{attrs:{icon:"el-icon-arrow-up",command:"preview"}},[t._v("Xem trực tiếp")]),e("el-dropdown-item",{attrs:{icon:"el-icon-top-right",command:"open-in-new-tab"}},[t._v("Mở trong tab\n                      mới")])],1)],1)],1)})),0)]}}])}),e("el-table-column",{attrs:{prop:"user.fullname",label:"Người đăng"},scopedSlots:t._u([{key:"default",fn:function(n){var a=n.row;return[e("div",{staticClass:"d-flex align-items-center"},[e("el-avatar",{attrs:{src:a.user.avatarUrl}}),e("p",{staticClass:"p-1 mt-1"},[t._v(t._s(a.user.fullname))])],1)]}}])}),e("el-table-column",{attrs:{label:"Thao tác",width:"150"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("router-link",{attrs:{to:{name:"Post",params:{id:n.row._id}}},on:{click:function(e){return t.scrollToQuestion(n.row._id)}}},[e("el-button",{attrs:{type:"primary",icon:"el-icon-view",size:"small",circle:""}})],1),t.isStudentRole?t._e():e("el-button",{staticClass:"ml-3",attrs:{type:"danger",icon:"el-icon-delete",size:"small",circle:""},on:{click:function(e){return e.preventDefault(),t.confirmDelete(n.row)}}})]}}])})],1)],1),e("div",{staticClass:"mt-2"},[e("el-pagination",{attrs:{background:"",layout:"jumper, prev, pager, next, sizes, total","page-sizes":[10,25,50,100],"page-size":t.pagination.page_size,total:t.totalItems,"current-page":t.pagination.current_page},on:{"update:pageSize":function(e){return t.$set(t.pagination,"page_size",e)},"update:page-size":function(e){return t.$set(t.pagination,"page_size",e)},"update:currentPage":function(e){return t.$set(t.pagination,"current_page",e)},"update:current-page":function(e){return t.$set(t.pagination,"current_page",e)},"current-change":t.handleCurrentPageChange,"size-change":t.handlePageSizeChange}})],1)])],1)},o=[],c=(n("28a5"),n("6762"),n("2fdb"),n("d25f"),n("caf6")),i=n("b166"),r=n("bc3a"),s=n.n(r),l=n("b510"),u=(n("15f5"),"Post"),d={data:function(){return{tableData:[],totalItems:0,totalPages:0,pagination:{current_page:1,page_size:10},search:"",typeList:["Thông báo","Tài liệu","Bài đăng"],selectedType:""}},created:function(){this.loadData()},computed:{filteredTableData:function(){var t=this;return this.tableData.filter((function(e){return(!t.search||e.title.toLowerCase().includes(t.search.toLowerCase()))&&(!t.selectedType||e.postType===t.selectedType)}))},isStudentRole:function(){return"student"===this.$store.getters.user.role}},methods:{goToAddNewPage:function(){this.$router.push({name:"post_main"})},handlePageSizeChange:function(t){this.pagination.page_size=t,this.pagination.current_page=1,this.loadData()},handleCurrentPageChange:function(t){this.pagination.current_page=t,this.loadData()},handleCommand:function(t,e){"download"===t?s()({url:e.path,method:"GET",responseType:"blob",baseURL:"https://backend-3lvb.onrender.com"}).then((function(t){var n=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=n,a.setAttribute("download",e.filename),document.body.appendChild(a),a.click(),document.body.removeChild(a)})).catch((function(t){console.error("Lỗi khi tải xuống tệp:",t)})):"preview"===t?this.$message.info("Xem trước tệp: ".concat(e.filename)):"open-in-new-tab"===t&&window.open(e.path,"_blank")},confirmDelete:function(t){var e=this;this.$confirm("Xác nhận xóa ".concat(u,"?"),"Cảnh báo",{confirmButtonText:"Xóa",type:"warning"}).then((function(){Object(c["c"])(t._id).then((function(n){var a=n.data;a.success&&(e.loadData(),Object(l["b"])(t._id))})).finally((function(){e.$wrLoading(!1)}))})).catch()},loadData:function(){var t=this;Object(c["b"])(this.pagination.current_page,this.pagination.page_size).then((function(e){e&&e.data&&e.data.success?(t.tableData=e.data.data.posts,t.totalItems=e.data.data.pagination.total,t.totalPages=e.data.data.pagination.totalPages):console.error("Không thành công: ",e.data)})).catch((function(t){console.error("Lỗi khi tải bài đăng: ",t)}))},formatDate:function(t){return Object(i["a"])(new Date(t),"dd/MM/yyyy")},getFileIconClass:function(t){var e=t.split(".").pop().toLowerCase(),n={class:"fas fa-file",color:"#333"};switch(e){case"pdf":n.class="fas fa-file-pdf",n.color="#ff0000";break;case"txt":n.class="fa-solid fa-file-lines",n.color="#00CCFF";break;case"doc":case"docx":n.class="fas fa-file-word",n.color="#2b5797";break;case"csv":case"csvx":case"xsl":case"xslx":n.class="fa-solid fa-file-excel",n.color="#1f8a70";break;default:break}return n},getFileButtonClass:function(t){var e=t.filename.split(".").pop().toLowerCase();return"pdf"===e?"pdf-button":"xls"===e||"xlsx"===e?"excel-button":"doc"===e||"docx"===e?"doc-button":"default-button"},resetFilters:function(){this.selectedType="",this.search="",this.loadData()}}},p=d,f=(n("6c2d"),n("2877")),g=Object(f["a"])(p,a,o,!1,null,null,null);e["default"]=g.exports}}]);